We have a web server container running the nginx image. The access and error logs generated by the web server are not critical 
enough to be placed on a persistent volume. However, Nautilus developers need access to the last 24 hours of logs so that they can trace issues and bugs. 
Therefore, we need to ship the access and error logs for the web server to a log-aggregation service. Following the separation of concerns principle, 
we implement the Sidecar pattern by deploying a second container that ships the error and access logs from nginx. Nginx does one thing, and 
it does it well—serving web pages. The second container also specializes in its task—shipping logs. Since containers are running on the same Pod, 
we can use a shared emptyDir volume to read and write logs.


Create a pod named webserver.

Create an emptyDir volume shared-logs.

Create two containers from nginx and ubuntu images with latest tag only and remember to mention tag i.e nginx:latest, nginx container name 
should be nginx-container and ubuntu container name should be sidecar-container on webserver pod.

Add command on sidecar-container "sh","-c","while true; do cat /var/log/nginx/access.log /var/log/nginx/error.log; sleep 30; done"

Mount the volume shared-logs on both containers at location /var/log/nginx, all containers should be up and running.

Note: The kubectl utility on jump_host has been configured to work with the kubernetes cluster.


Pod name: `webserver`
Volume: `shared-logs` of type `emptyDir`
Containers:

  1. nginx-containe

     Image: `nginx:latest`
     Mount `/var/log/nginx` to the shared volume
  2. sidecar-container

     Image: `ubuntu:latest`
     Command:

       sh -c "while true; do cat /var/log/nginx/access.log /var/log/nginx/error.log; sleep 30; done"
     Mount `/var/log/nginx` to the shared volume

This means nginx writes logs to `/var/log/nginx`, and the sidecar reads them from the same location via the shared `emptyDir`.

Full YAML Manifest

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: webserver
spec:
  volumes:
    - name: shared-logs
      emptyDir: {}
  containers:
    - name: nginx-container
      image: nginx:latest
      volumeMounts:
        - name: shared-logs
          mountPath: /var/log/nginx

    - name: sidecar-container
      image: ubuntu:latest
      command: ["sh", "-c", "while true; do cat /var/log/nginx/access.log /var/log/nginx/error.log; sleep 30; done"]
      volumeMounts:
        - name: shared-logs
          mountPath: /var/log/nginx

 Apply the manifest

kubectl apply -f webserver.yaml

Then verify everything is running:
kubectl get pods
kubectl describe pod webserver


You should see both containers (`nginx-container`, `sidecar-container`) in Running state.

To verify log sharing:

Run:
kubectl exec -it webserver -c sidecar-container -- tail /var/log/nginx/access.log

If you hit nginx (`curl <pod-ip>`), you’ll see the access log lines appear!



